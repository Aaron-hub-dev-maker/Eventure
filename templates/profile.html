<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile | Eventure</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .profile-container { max-width: 700px; margin: 32px auto; background: #fff; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); padding: 32px 28px; }
        .profile-header { display: flex; align-items: center; gap: 18px; margin-bottom: 24px; }
        .profile-header i { font-size: 2.2em; color: #4CAF50; }
        .profile-header h2 { margin: 0; font-size: 1.6em; color: #1976d2; }
        .profile-form label { font-weight: 600; color: #1976d2; }
        .profile-form input { margin-bottom: 12px; }
        .event-list-section { margin-top: 32px; }
        .event-list-section h3 { color: #4CAF50; margin-bottom: 10px; }
        .event-list { display: flex; flex-wrap: wrap; gap: 16px; }
        .event-card { background: #f7f7f7; border-radius: 8px; padding: 14px 18px; min-width: 220px; flex: 1 1 220px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
        .event-card h4 { margin: 0 0 6px 0; font-size: 1.1em; color: #1976d2; }
        .event-card p { margin: 0 0 4px 0; font-size: 0.98em; }
    </style>
</head>
<body>
    <div id="header-container">
        <header style="padding: 18px 0 0 0; border-bottom: 1px solid #e0e0e0; background: #f8fafc;">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; max-width: 1200px; margin: 0 auto; padding: 0 24px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fa-solid fa-calendar-days" style="color:#4CAF50; font-size:2em;"></i>
                    <span class="eventure-logo-text" style="font-size:2em; font-weight:700; letter-spacing:1px;">Eventure</span>
                </div>
                <nav style="display: flex; gap: 18px; flex-wrap: wrap; margin-top: 8px;">
                    <a href="/">Home</a>
                    <a href="/host">Host an Event</a>
                    <a href="/referrals">Referrals</a>
                    <a href="/FAQ">FAQ</a>
                    <a href="/contact">Contact</a>
                    <a href="/profile" class="btn" style="background:#1976d2;">Profile</a>
                </nav>
                <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
                    <button id="dark-mode-toggle" style="padding:6px 16px;border-radius:20px;border:none;background:#23272a;color:#fff;cursor:pointer;font-weight:600;">üåô Dark Mode</button>
                    {% if current_user.is_authenticated %}
                        <a href="{{ url_for('profile') }}" style="font-weight:600;color:#4CAF50;text-decoration:none;display:inline-flex;align-items:center;gap:6px;">
                            <i class="fa fa-user-circle"></i>Welcome, {{ current_user.username }}!
                        </a>
                        <a href="/logout" class="btn" style="background:#f44336;">Logout</a>
                    {% else %}
                        <a href="/login" class="btn">Login</a>
                        <a href="/register" class="btn" style="background:#00bcd4;">Register</a>
                    {% endif %}
                </div>
            </div>
        </header>
    </div>
    <div class="profile-container">
        <div class="profile-header">
            <i class="fa fa-user-circle"></i>
            <h2>{{ user.full_name|default(user.username) }}'s Profile</h2>
        </div>
        <form class="profile-form" method="POST" style="margin-bottom:24px;">
            <label>Full Name</label>
            <input type="text" name="full_name" value="{{ user.full_name }}" class="form-control" required><br>
            <label>Username</label>
            <input type="text" value="{{ user.username }}" class="form-control" readonly style="background:#f5f5f5;"><br>
            <label>Email</label>
            <input type="email" value="{{ user.email }}" class="form-control" readonly style="background:#f5f5f5;"><br>
            <label>Phone</label>
            <input type="text" name="phone" value="{{ user.phone }}" class="form-control"><br>
            <label>City</label>
            <input type="text" name="city" value="{{ user.city }}" class="form-control"><br>
            <button type="submit" class="btn" style="background:#4CAF50;width:100%;margin-top:10px;">Save Changes</button>
        </form>
        <div style="margin:32px 0 24px 0; padding:24px 18px; background:#f7f7f7; border-radius:10px; max-width:420px;">
            <h3 style="color:#1976d2;margin-bottom:12px;"><i class="fa fa-key"></i> Change Password</h3>
            {% if password_error %}
                <div style="color:#c62828;background:#ffebee;border-left:5px solid #f44336;padding:8px 12px;border-radius:4px;margin-bottom:10px;font-weight:600;">{{ password_error }}</div>
            {% endif %}
            <form method="POST">
                <input type="hidden" name="change_password" value="1">
                <label>Current Password</label>
                <input type="password" name="current_password" class="form-control" required style="margin-bottom:10px;">
                <label>New Password</label>
                <input type="password" name="new_password" class="form-control" required style="margin-bottom:10px;">
                <label>Confirm New Password</label>
                <input type="password" name="confirm_password" class="form-control" required style="margin-bottom:10px;">
                <button type="submit" class="btn" style="background:#1976d2;width:100%;">Update Password</button>
            </form>
        </div>
        <div class="event-list-section">
            <h3><i class="fa fa-ticket"></i> Events You've Booked</h3>
            {% if booked_events %}
            <div class="event-list">
                {% for event in booked_events %}
                <div class="event-card">
                    <h4>{{ event.Name }}</h4>
                    <p><i class="fa fa-calendar"></i> {{ event.Date.strftime('%b %d, %Y') if event.Date.__class__.__name__ == 'datetime' else event.Date }}</p>
                    <p><i class="fa fa-map-marker-alt"></i> {{ event.Place }}</p>
                    <p><i class="fa fa-tag"></i> {{ event.Category }}</p>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p style="color:#888;">You haven't booked any events yet.</p>
            {% endif %}
        </div>
        <div class="event-list-section">
            <h3><i class="fa fa-star"></i> Events You've Hosted</h3>
            {% if hosted_events %}
            <div class="event-list">
                {% for event in hosted_events %}
                <div class="event-card">
                    <h4>{{ event.Name }}</h4>
                    <p><i class="fa fa-calendar"></i> {{ event.Date.strftime('%b %d, %Y') if event.Date.__class__.__name__ == 'datetime' else event.Date }}</p>
                    <p><i class="fa fa-map-marker-alt"></i> {{ event.Place }}</p>
                    <p><i class="fa fa-tag"></i> {{ event.Category }}</p>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p style="color:#888;">You haven't hosted any events yet.</p>
            {% endif %}
        </div>
    </div>
    <footer>
        <div style="max-width:1200px;margin:0 auto;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:12px;">
            <div style="font-size:1.1em;font-weight:600;letter-spacing:1px;">Eventure</div>
            <div style="font-size:0.98em;">&copy; 2024 Eventure. All rights reserved.</div>
            <div style="font-size:1.3em;">
                <a href="#" style="color:#fff;margin:0 8px;"><i class="fab fa-facebook"></i></a>
                <a href="#" style="color:#fff;margin:0 8px;"><i class="fab fa-instagram"></i></a>
                <a href="#" style="color:#fff;margin:0 8px;"><i class="fab fa-twitter"></i></a>
            </div>
        </div>
    </footer>
    <script>
        // Robust dark mode toggle
        document.addEventListener('DOMContentLoaded', function() {
            const darkToggleBtn = document.getElementById('dark-mode-toggle');
            function setDarkMode(on) {
                if (on) {
                    document.body.classList.add('dark-mode');
                    darkToggleBtn.textContent = '‚òÄÔ∏è Light Mode';
                } else {
                    document.body.classList.remove('dark-mode');
                    darkToggleBtn.textContent = 'üåô Dark Mode';
                }
            }
            const darkPref = localStorage.getItem('darkMode') === 'true';
            setDarkMode(darkPref);
            darkToggleBtn.onclick = function() {
                const isDark = !document.body.classList.contains('dark-mode');
                setDarkMode(isDark);
                localStorage.setItem('darkMode', isDark);
            };
        });
    </script>
</body>
</html> 